WITH S AS
	(SELECT PROD
		FROM SALES
		GROUP BY PROD),
	Q1 AS
	(SELECT PROD,
			MAX(QUANT)AS Q1
		FROM SALES
		WHERE MONTH BETWEEN 1 AND 3
		GROUP BY PROD
		ORDER BY PROD),
	Q1_DATE AS
	(SELECT Q1.PROD,
			Q1.Q1,
			S.DATE
		FROM Q1
		JOIN SALES AS S ON Q1.PROD = S.PROD
		AND Q1.Q1 = S.QUANT),
	Q2 AS
	(SELECT PROD,
			MAX(QUANT)AS Q2
		FROM SALES
		WHERE MONTH BETWEEN 4 AND 6
		GROUP BY PROD
		ORDER BY PROD),
	Q2_DATE AS
	(SELECT Q2.PROD,
			Q2.Q2,
			S.DATE
		FROM Q2
		JOIN SALES AS S ON Q2.PROD = S.PROD
		AND Q2.Q2 = S.QUANT),
	Q3 AS
	(SELECT PROD,
			MAX(QUANT)AS Q3
		FROM SALES
		WHERE MONTH BETWEEN 7 AND 9
		GROUP BY PROD
		ORDER BY PROD),
	Q3_DATE AS
	(SELECT Q3.PROD,
			Q3.Q3,
			S.DATE
		FROM Q3
		JOIN SALES AS S ON Q3.PROD = S.PROD
		AND Q3.Q3 = S.QUANT),
	Q4 AS
	(SELECT PROD,
			MAX(QUANT)AS Q4
		FROM SALES
		WHERE MONTH BETWEEN 10 AND 12
		GROUP BY PROD
		ORDER BY PROD),
	Q4_DATE AS
	(SELECT Q4.PROD,
			Q4.Q4,
			S.DATE
		FROM Q4
		JOIN SALES AS S ON Q4.PROD = S.PROD
		AND Q4.Q4 = S.QUANT)
SELECT S.PROD,
	Q1.Q1,
	Q1.DATE,
	Q2.Q2,
	Q2.DATE,
	Q3.Q3,
	Q3.DATE,
	Q4.Q4,
	Q4.DATE
FROM S
FULL OUTER JOIN Q1_DATE AS Q1 ON Q1.PROD = S.PROD
FULL OUTER JOIN Q2_DATE AS Q2 ON Q2.PROD = S.PROD
FULL OUTER JOIN Q3_DATE AS Q3 ON Q3.PROD = S.PROD
FULL OUTER JOIN Q4_DATE AS Q4 ON Q4.PROD = S.PROD
ORDER BY PROD;